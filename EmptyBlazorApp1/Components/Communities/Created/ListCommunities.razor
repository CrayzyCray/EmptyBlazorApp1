@using MudBlazor
@using EmptyBlazorApp1.Services
@using EmptyBlazorApp1.Components.Misc
@using EmptyBlazorApp1.Entities

@inject DbService DbService
@inject AuthenticationService AS

<MudButton 
    OnClick="Callback"
    FullWidth="true" 
    Variant="Variant.Outlined" 
    Color="Color.Success" >Создать сообщество</MudButton>

@if (communities is not null)
    @foreach (var community in communities) {
        <СommunityCard Community="community" />
    }

@code {
    [Parameter] public Action? Callback { get; set; }
    List<Community>? communities;

    protected override void OnInitialized() {
        var user = AS.GetUserWithProfile();
        if (user is not null)
            communities = DbService.GetCreatedCommunities(user);
    }
}
