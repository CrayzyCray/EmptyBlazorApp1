@using System.Text.RegularExpressions
@using System.ComponentModel.DataAnnotations
@using MudBlazor
@using EmptyBlazorApp1.Services
@using EmptyBlazorApp1.Entities

@inject DbService dbService


<MudTabs Elevation="4" Rounded="true" Centered="true" ApplyEffectsToContainer="true" PanelClass="pa-6">
    <MudTabPanel Text="Login">
        <MudStack>
            <MudTextField @bind-Value="LoginCode" Label="Code" Variant="Variant.Filled"></MudTextField>
            <MudButton OnClick="LoginButtonOnClick" Variant="Variant.Filled" Color="Color.Primary">Login</MudButton>
        </MudStack>
    </MudTabPanel>
    <MudTabPanel Text="Register">
        <MudStack>
            <MudTextField @bind-Value="RegisterCode" Label="Code" Variant="Variant.Filled"></MudTextField>
            <MudTextField @bind-Value="Info" Label="Info" Variant="Variant.Filled"></MudTextField>
            <MudButton OnClick="RegisterButtonOnClick" Variant="Variant.Filled" Color="Color.Primary">Register</MudButton>
        </MudStack>
    </MudTabPanel>
</MudTabs>

@code {
    [Parameter]
    public Action? action { get; set; }
    public string LoginCode { get; set; } = string.Empty;
    public string RegisterCode { get; set; } = string.Empty;
    public string Info { get; set; } = string.Empty;

    private void LoginButtonOnClick() {
        Console.WriteLine(LoginCode);
    }

    private void RegisterButtonOnClick() {
        Console.WriteLine($"{RegisterCode}\n{Info}");
        dbService.DbContext.Users.Add(new User() { LoginCode = RegisterCode, Name = Info });
        dbService.DbContext.SaveChanges();
        //DbContext.Users.Add(new User() { LoginCode = RegisterCode, Name = Info });
    }
}